<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>Grouping ListBox-Items | a1300 Blog</title><link rel="stylesheet" type="text/css" href="/css/normalize.css"><link rel="stylesheet" type="text/css" href="/css/highlight.css"><link rel="stylesheet" type="text/css" href="/css/very-simple.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"></head><body><!-- include the sidebar--><!-- include ./includes/sidebar.jade--><!-- Blog title and subtitle--><header><div class="container header"><a id="logo" href="/." class="title">a1300 Blog</a><span class="subtitle">Blog about Programming</span><label id="toggle-menu" for="menu" onclick><i class="fa fa-bars"></i></label></div></header><!-- use checkbox hack for toggle nav-bar on small screens--><input id="menu" type="checkbox"><!-- Navigation Links--><nav id="nav"><div class="container"><a href="/" class="sidebar-nav-item active">Home</a><a href="/archives" class="sidebar-nav-item">Archives</a></div></nav><div id="header-margin-bar"></div><!-- gallery that comes before the header--><div class="wrapper"><div class="container post-header"><h1>Grouping ListBox-Items</h1></div></div><div class="wrapper"><div class="container meta"><div class="post-time">2016-12-13</div><div class="post-tags"><a class="post-tag-link" href="/tags/WPF-ListBox-CollectionViewSource/">WPF, ListBox, CollectionViewSource</a></div></div></div><article><div class="container post"><p>Imagine you want to give the user the option to specify the columns of an DataGrid or GridView. You could pop out a dialog that shows all available columns on the left side and all visible columns on the right side. Like in the following picture.</p>
<img src="/2016/12/13/Grouping-ListBox-Items/before.png" alt="Simple Options" title="Simple Options">
<p>This example shows two ListBoxes that bind to two collections in a <a href="https://msdn.microsoft.com/en-us/magazine/dd419663.aspx" title="Model-View-ViewModel Design Pattern" target="_blank" rel="external">MVVM</a>-Manner.<br>The underlying model is a simple class.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">public class Category</div><div class="line">&#123;</div><div class="line">    public string Name &#123; get; set; &#125;</div><div class="line">    public CategoryType Type &#123; get; set; &#125;</div><div class="line"></div><div class="line">    public override string ToString()</div><div class="line">    &#123;</div><div class="line">        return Name ?? &quot;No Category-Name&quot;;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">public enum CategoryType</div><div class="line">&#123;</div><div class="line">    Image = 0,</div><div class="line">    GeneralInformation = 1,</div><div class="line">    AddressData</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p>If you want to group belonging options together you could make use of the ‘’CollectionViewSource’’. That way the user’s eye must not search the whole list to find belonging items.</p>
<img src="/2016/12/13/Grouping-ListBox-Items/after.png" alt="This is an example image" title="This is an example image">
<p>In the constructor of the ViewModel will be the ObservableCollection of Category initialized and populated with Dummy-Data.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">AvailableColumns = new ObservableCollection&lt;Category&gt;();</div><div class="line">AvailableColumns.Add(new Category() </div><div class="line">    &#123; Name = &quot;Thumbnail&quot;, Type = CategoryType.Image &#125;);</div><div class="line">AvailableColumns.Add(new Category() </div><div class="line">    &#123; Name = &quot;LastName&quot;, Type = CategoryType.GeneralInformation &#125;);</div><div class="line">AvailableColumns.Add(new Category() </div><div class="line">    &#123; Name = &quot;ZIP&quot;, Type = CategoryType.AddressData &#125;);</div></pre></td></tr></table></figure></p>
<p>In the view binds the ‘CollectionViewSource’ to the ObservableCollection AvailableColumns. Furthermore is the CollectionViewSource.GroupDescriptions set. The PropertyName is set to “Type” of the Class Category. Category is the underlying Model for the Collection.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;CollectionViewSource x:Key=&quot;GroupedItemsLeft&quot; Source=&quot;&#123;Binding AvailableColumns&#125;&quot;&gt;</div><div class="line">    &lt;CollectionViewSource.GroupDescriptions&gt;</div><div class="line">        &lt;PropertyGroupDescription PropertyName=&quot;Type&quot;/&gt;</div><div class="line">    &lt;/CollectionViewSource.GroupDescriptions&gt;</div><div class="line">&lt;/CollectionViewSource&gt;</div></pre></td></tr></table></figure></p>
<img src="/2016/12/13/Grouping-ListBox-Items/PropertyName_Type.PNG" alt="Show the PropertyName Type which uses the CollectionViewSource as GroupDescription" title="Show the PropertyName Type which uses the CollectionViewSource as GroupDescription">
<p>The CollectionViewSource with the Key “GroupedItemsLeft” can now be used as Binding-Source for the ListBox. Please note that the CollectionViewSource doesn’t changes the data of the underlying ObservableCollection. It can display the data for the user in a different way.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&lt;ListBox ItemsSource=&quot;&#123;Binding Source=&#123;StaticResource GroupedItemsLeft&#125;, </div><div class="line">    Mode=OneWay, UpdateSourceTrigger=PropertyChanged&#125;&quot;/&gt;</div></pre></td></tr></table></figure></p>
<p>Entire Source-Code on <a href="https://github.com/a1300/TonyW_Expanders_Example" title="a1300" target="_blank" rel="external">GitHub</a>-Repo.</p>
<blockquote><footer><strong>Source for CollectionViewSource from stackoverflow-User Michael Stoll</strong><cite><a href="http://stackoverflow.com/questions/2595669/bind-listbox-in-wpf-with-grouping/2598299#2598299" target="_blank" rel="external">stackoverflow.com/questions/2595669/bind-listbox-in-wpf-with-grouping/2598299#2598299</a></cite></footer></blockquote></div><!-- comment system--><div class="container"><hr></div></article><footer id="footer"><div class="container"><div class="bar"><div class="social"><a href="/atom.xml" target="_blank"><i class="fa fa-rss"></i></a></div><div class="footer">© 2016 <a href="/" rel="nofollow">a1300 Codes</a>. Powered by <a rel="nofollow" target="_blank" href="https://hexo.io">Hexo</a>. Theme <a target="_blank" href="https://github.com/lotabout/very-simple">very-simple</a>.</div></div></div></footer><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.css"><script src="//cdn.bootcss.com/jquery/2.0.3/jquery.min.js"></script><script src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js"></script><script>$(document).ready(function() {
    $(".fancybox").fancybox();
});
</script></body></html>